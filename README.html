<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        &lt;img src=&apos;https://github.com/t - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@hackmd/emojify.js@2.1.0/dist/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{background:#fff;color:#333;display:block;overflow-x:auto;padding:.5em}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{background-color:#eaffea;color:#55a532}.hljs-deletion{background-color:#ffecec;color:#bd2c00}.hljs-link{text-decoration:underline}.markdown-body{word-wrap:break-word;font-size:16px;line-height:1.5}.markdown-body:after,.markdown-body:before{content:"";display:table}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;line-height:1;margin-left:-20px;padding-right:4px}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-bottom:16px;margin-top:0}.markdown-body hr{background-color:#e7e7e7;border:0;height:.25em;margin:24px 0;padding:0}.markdown-body blockquote{border-left:.25em solid #ddd;color:#777;font-size:16px;padding:0 1em}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{background-color:#fcfcfc;border:1px solid;border-color:#ccc #ccc #bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb;color:#555;display:inline-block;font-size:11px;line-height:10px;padding:3px 5px;vertical-align:middle}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{font-weight:600;line-height:1.25;margin-bottom:16px;margin-top:24px}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{border-bottom:1px solid #eee;padding-bottom:.3em}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{color:#777;font-size:.85em}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{list-style-type:none;padding:0}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-bottom:0;margin-top:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{padding-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{font-size:1em;font-style:italic;font-weight:700;margin-top:16px;padding:0}.markdown-body dl dd{margin-bottom:16px;padding:0 16px}.markdown-body table{display:block;overflow:auto;width:100%;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{border:1px solid #ddd;padding:6px 13px}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{background-color:#fff;box-sizing:initial;max-width:100%}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{background-color:initial;max-width:none;vertical-align:text-top}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{border:1px solid #ddd;display:block;float:left;margin:13px 0 0;overflow:hidden;padding:7px;width:auto}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{clear:both;color:#333;display:block;padding:5px 0 0}.markdown-body span.align-center{clear:both;display:block;overflow:hidden}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{clear:both;display:block;overflow:hidden}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{background-color:#0000000a;border-radius:3px;font-size:85%;margin:0;padding:.2em 0}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{content:"\00a0";letter-spacing:-.2em}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{background:#0000;border:0;font-size:100%;margin:0;padding:0;white-space:pre;word-break:normal}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{border-radius:3px;font-size:85%;line-height:1.45;overflow:auto}.markdown-body:not(.next-editor) pre{background-color:#f7f7f7;padding:16px}.markdown-body pre code,.markdown-body pre tt{word-wrap:normal;background-color:initial;border:0;display:inline;line-height:inherit;margin:0;max-width:auto;overflow:visible;padding:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{font-size:12px;line-height:1;overflow:hidden;padding:5px;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{background:#fff;border:0;padding:10px 8px 9px;text-align:right}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{background:#f8f8f8;border-top:0;font-weight:700}.news .alert .markdown-body blockquote{border:0;padding:0 0 0 40px}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{cursor:default!important;float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle}.markdown-body{max-width:758px;overflow:visible!important;padding-bottom:40px;padding-top:40px;position:relative}.markdown-body.next-editor{overflow-x:hidden!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{border-right:3px solid #6ce26c!important;box-sizing:initial;color:#afafaf!important;cursor:default;display:inline-block;min-width:20px;padding:0 8px 0 0;position:relative;text-align:right;z-index:4}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-bottom:none;border-left:none;border-top:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-collapse:inherit!important;border-spacing:0}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{margin-bottom:unset;overflow:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert{display:flex;flex-direction:column;gap:16px}.markdown-body .alert>*{margin:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram,.markdown-body pre.vega{background-color:inherit;border-radius:0;overflow:visible;text-align:center;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code,.markdown-body pre.vega>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg,.markdown-body pre.vega>svg{height:100%;max-width:100%}.markdown-body pre>code.wrap{word-wrap:break-word;white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{background-color:#000;background-position:50%;background-repeat:no-repeat;background-size:contain;cursor:pointer;display:table;overflow:hidden;text-align:center}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{object-fit:contain;width:100%;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{height:100%;left:0;position:absolute;top:0;width:100%}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{color:#fff;height:auto;left:50%;opacity:.3;position:absolute;top:50%;transform:translate(-50%,-50%);transition:opacity .2s;width:auto;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.figma{display:table;padding-bottom:56.25%;position:relative;width:100%}.figma iframe{border:1px solid #eee;bottom:0;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.markmap-container{height:300px}.markmap-container>svg{height:100%;width:100%}.MJX_Assistive_MathML{display:none}#MathJax_Message{z-index:1000!important}.ui-infobar{color:#777;margin:25px auto -25px;max-width:760px;position:relative;z-index:2}.toc .invisable-node{list-style-type:none}.ui-toc{bottom:20px;position:fixed;z-index:998}.ui-toc.both-mode{margin-left:8px}.ui-toc.both-mode .ui-toc-label{border-bottom-left-radius:0;border-top-left-radius:0;height:40px;padding:10px 4px}.ui-toc-label{background-color:#e6e6e6;border:none;color:#868686;transition:opacity .2s}.ui-toc .open .ui-toc-label{color:#fff;opacity:1;transition:opacity .2s}.ui-toc-label:focus{background-color:#ccc;color:#000;opacity:.3}.ui-toc-label:hover{background-color:#ccc;opacity:1;transition:opacity .2s}.ui-toc-dropdown{margin-bottom:20px;margin-top:20px;max-height:70vh;max-width:45vw;overflow:auto;padding-left:10px;padding-right:10px;text-align:inherit;width:25vw}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{letter-spacing:.0029em;padding-right:0}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{color:#767676;display:block;font-size:13px;font-weight:500;padding:4px 20px}.ui-toc-dropdown .nav>li:first-child:last-child>ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{background-color:initial;border-left:1px solid #000;color:#000;padding-left:19px;text-decoration:none}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{border-left:none;border-right:1px solid #000;padding-right:19px}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{background-color:initial;border-left:2px solid #000;color:#000;font-weight:700;padding-left:18px}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{border-left:none;border-right:2px solid #000;padding-right:18px}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:30px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{font-size:12px;font-weight:400;padding-bottom:1px;padding-left:40px;padding-top:1px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{font-weight:500;padding-left:28px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{font-weight:500;padding-left:38px}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{max-height:70vh;max-width:15vw;overflow:auto;position:fixed;top:0}.back-to-top,.expand-toggle,.go-to-bottom{color:#999;display:block;font-size:12px;font-weight:500;margin-left:10px;margin-top:10px;padding:4px 10px}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{background-position:50%;background-repeat:no-repeat;background-size:cover;border-radius:50%;display:block;height:20px;margin-bottom:2px;margin-right:5px;margin-top:2px;width:20px}.ui-user-icon.small{display:inline-block;height:18px;margin:0 0 .2em;vertical-align:middle;width:18px}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-more-info{color:#888;cursor:pointer;vertical-align:middle}.ui-more-info .fa{font-size:16px}.ui-connectedGithub,.ui-published-note{color:#888}.ui-connectedGithub{line-height:23px;white-space:nowrap}.ui-connectedGithub a.file-path{color:#888;padding-left:22px;text-decoration:none}.ui-connectedGithub a.file-path:active,.ui-connectedGithub a.file-path:hover{color:#888;text-decoration:underline}.ui-connectedGithub .fa{font-size:20px}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}.selectable{-webkit-user-select:text;-o-user-select:text;user-select:text}.inline-spoiler-section{cursor:pointer}.inline-spoiler-section .spoiler-text{background-color:#333;border-radius:2px}.inline-spoiler-section .spoiler-text>*{opacity:0}.inline-spoiler-section .spoiler-img{filter:blur(10px)}.inline-spoiler-section.raw{background-color:#333;border-radius:2px}.inline-spoiler-section.raw>*{opacity:0}.inline-spoiler-section.unveil{cursor:auto}.inline-spoiler-section.unveil .spoiler-text{background-color:#3333331a}.inline-spoiler-section.unveil .spoiler-text>*{opacity:1}.inline-spoiler-section.unveil .spoiler-img{filter:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{color:#222;position:relative;z-index:1}.markdown-body.slides:before{background-color:currentColor;bottom:0;box-shadow:0 0 0 50vw;content:"";display:block;left:0;position:absolute;right:0;top:0;z-index:-1}.markdown-body.slides section[data-markdown]{background-color:#fff;margin-bottom:1.5em;position:relative;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{left:1em;max-height:100%;overflow:hidden;position:absolute;right:1em;top:50%;transform:translateY(-50%)}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{border:3px solid #777;content:"";height:1.5em;position:absolute;right:1em;top:-1.5em}.site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .site-ui-font{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;-webkit-overflow-scrolling:touch;font-family:Source Sans Pro,Helvetica,Arial,sans-serif;letter-spacing:.025em}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}svg{text-shadow:none}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-inner comment-enabled" data-hard-breaks="false"><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/c139dcc66ea1348046c30373337151e14888f932/assets/header.png?raw=true" width="800" height="300"><h1 id="In-Vino-Veritas" data-id="In-Vino-Veritas"><a class="anchor hidden-xs" href="#In-Vino-Veritas" title="In-Vino-Veritas"><span class="octicon octicon-link"></span></a><span>In Vino Veritas</span></h1><p><span>An university project on data engineering with Airflow based on wine data</span></p><h2 id="Table-of-contents" data-id="Table-of-contents"><a class="anchor hidden-xs" href="#Table-of-contents" title="Table-of-contents"><span class="octicon octicon-link"></span></a><span>Table of contents</span></h2><ul>
<li><a href="#introduction"><span>Introduction</span></a></li>
<li><a href="#data-sources"><span>Data Sources</span></a>
<ul>
<li><a href="#main-data"><span>Main Data</span></a></li>
<li><a href="#enrichment-data"><span>Enrichment Data</span></a></li>
</ul>
</li>
<li><a href="#pipeline"><span>Pipeline</span></a>
<ul>
<li><a href="#ingestion"><span>Ingestion</span></a></li>
<li><a href="#staging"><span>Staging</span></a>
<ul>
<li><a href="#cleansing"><span>Cleansing</span></a></li>
<li><a href="#enrichments"><span>Enrichments</span></a></li>
</ul>
</li>
<li><a href="#production"><span>Production</span></a>
<ul>
<li><a href="#queries"><span>Queries</span></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#future-developments"><span>Future developments</span></a></li>
<li><a href="#results-and-conclusion"><span>Results and Conclusion</span></a></li>
<li><a href="#how-to-run"><span>How to run?</span></a></li>
</ul><h1 id="Introduction" data-id="Introduction"><a class="anchor hidden-xs" href="#Introduction" title="Introduction"><span class="octicon octicon-link"></span></a><span>Introduction</span></h1><p><span>In ‘Vino Veritas’ is an old Latin phrase that means ‘in wine, there is truth’. And we would like to obtain said truth in wine. What is (subjectively/objectively)good wine? Do superstitions hold true? E.g., Are there countries with better wine? Are expensive wines better?	Are old wines better?	How does good wine taste and what chemical characteristics does it have?</span>
<span>Big data is already an integral part in the wine industry and readily used to gain insights. Our ultimate goal is to achieve this by obtaining and transforming relevant data in an efficient and coordinated manner before we analyze the data.</span></p><h1 id="Data-Sources" data-id="Data-Sources"><a class="anchor hidden-xs" href="#Data-Sources" title="Data-Sources"><span class="octicon octicon-link"></span></a><span>Data Sources</span></h1><h2 id="Main-Data" data-id="Main-Data"><a class="anchor hidden-xs" href="#Main-Data" title="Main-Data"><span class="octicon octicon-link"></span></a><span>Main Data</span></h2><p><span>For our objective perspective on data we utilize a static wine quality data set from 2009 which can be download as CSV or through an API.</span>
<span>Its target variable </span><code>quality</code><span> is judged through blind tasting by professional sommeliers and the wines underlying chemical properties are analyzed rendering the following features:</span></p><pre><code>'fixed_acidity’, 'volatile_acidity’, 'citric_acid’,  'pH',  
'sulphates’,  'free_sulfur_dioxide',  'total_sulfur_dioxide’, 
'residual_sugar’, 'density’,  'alcohol', 'chlorides’
</code></pre><p><span>However, the backbone of our data sources is </span><a href="" target="_blank" rel="noopener"><span>vivino.com</span></a><span> – A website based on users’ ratings and entries. Including different dimensions from rating, region, vintage, grape variety, and taste profile in the ranges:</span></p><ul>
<li><span>Light – Bold</span></li>
<li><span>Smooth – Tannic</span></li>
<li><span>Dry – Sweet</span></li>
<li><span>Soft – Acidic</span>
<span>The data is scraped with Python, thus rendering an already structured albeit uncleaned output.</span></li>
</ul><h2 id="Enrichment-Data" data-id="Enrichment-Data"><a class="anchor hidden-xs" href="#Enrichment-Data" title="Enrichment-Data"><span class="octicon octicon-link"></span></a><span>Enrichment Data</span></h2><p><span>To enrich our data from with vivino we have multiple data sets. The first is global harvest data provided by the Food and Agriculture Organization Corporate Statistical Database&nbsp;(FAOSTAT). It can be downloaded as CSV or called through an API. The data is lagging 2 years, which means it currently ends at 2021. We assume the amount of (grape and wine) harvest is a strong indicator of agricultural conditions, but weather it also is a indicator for a subjectively good wine year is to be analyzed because quantity != quality.</span></p><p><span>Our second enrichment data leverages Google trends – an analysis tool visualizing the popularity of search queries&nbsp;in Google Search. The reason we include it is the so called ‘Sideways’ effect:</span></p><img src="https://i.imgur.com/KpG7hK7.png" width="550"><p><span>In the 2005 movie ‘Sideways’, the grape variety ‘Pinot Noir’ was continuously presented as good wine, while the protagonist announced to not drink any more f****ng ‘Merlot’. This resulted in a shift in consumer behavior.</span>
<span>To show which wine was trending we utilize an unofficial Python API.</span></p><p><span>For the last dimension to enrich our vivino data, we obtain weather data based on the wines exact region. We follow a matryoshka approach of nesting an API in an API. The GPS location is extracted from the </span><a href="http://vivino.com" target="_blank" rel="noopener"><span>vivino.com</span></a><span> region via Geopy. And then we can obtain a weather time series based on the GPS via meteostat. But a time series != feature. So we need to leverage expert domain knowledge to turn our raw time series in substantial features. Our feature engineering approach is based on </span><a href="https://www.idealwine.info/conditions-for-great-wine/" target="_blank" rel="noopener"><span>idealwine</span></a><span> </span><a href="https://www.idealwine.info/conditions-necessary-great-wine-part-12/" target="_blank" rel="noopener"><span>.info</span></a><span> for the growth period (March 11th – September 20th) of the wines </span><a href="https://en.wikipedia.org/wiki/Harvest_(wine)" target="_blank" rel="noopener"><span>Source</span></a><span>:</span></p><blockquote>
<p><span>A fairly cold winter, a spring with alternating periods of sunshine and occasional rain, a fairly hot and dry summer with the odd shower to ward off water stress, and rain-free harvesting… conditions like these will virtually guarantee a good year.</span></p>
</blockquote><blockquote>
<p><span>At temperatures below 10°C and above 35°C, photosynthesis will be disrupted, and vines will not grow properly.</span></p>
</blockquote><blockquote>
<p><span>Vines need between 400 and 600 mm of rain per year. […] A regular supply of water throughout the growth cycle is needed for a high-quality crop.</span></p>
</blockquote><blockquote>
<p><span>Too much rain and damp during the May-July period can lead to the appearance of diseases such as mildew or oidium, which are caused by the growth of tiny fungi.</span></p>
</blockquote><blockquote>
<p><span>If there is rain or […] strong wind during flowering, the pollen will be unable to achieve its task of pollinating the flowers. This is known as&nbsp;‘coulure’.</span></p>
</blockquote><h1 id="Pipeline" data-id="Pipeline"><a class="anchor hidden-xs" href="#Pipeline" title="Pipeline"><span class="octicon octicon-link"></span></a><span>Pipeline</span></h1><p><span>The overall pipeline is implemented in Apache Airflow and can be separated in three sections: Ingestion, Staging and Production.</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/b4b79eb366526871cbc19a5dbce55ca872529332/assets/Flow%20Diagram.png?raw=true" width="750"><p><span>Below is the detailed description of each step.</span>
<span>Each main task generates their own tables if they dont exist yet:</span></p><ol>
<li>
<p><code>show_params</code><span>: Debug steps to later easily examine the given parameters to a certain run.</span></p>
</li>
<li>
<p><code>pm_scrape</code><span>: Using the papermill operator and a jupyter notebook source file, the vivino website is scraped. The resulting pandas dataframe is converted into a parquet file and stored locally. In case of offline_mode usage, this step reads a predetermined .csv file instead scraping the website.</span></p>
</li>
<li>
<p><code>pm_clean</code><span>: With the papermill operator, the raw scraped data is passed through several steps where the dataframe is pruned from missing or incorrect data. Among these steps are:</span></p>
<ol>
<li><span>Dropping invalid regions. Based on a whitelist-blacklist system.</span></li>
<li><span>Dropping entries with no vintage given.</span></li>
<li><span>Changing column types to more appropiate ones.</span></li>
</ol>
</li>
<li>
<p><code>postgres_connect</code><span>: this step ensures that a postgres type connection is added to the airflow connections list in case other scripts would like to connect to it (and if they need such method for that)</span></p>
</li>
<li>
<p><code>upload_postgres</code><span>: the cleaned data is read, and then line-by-line inserted into the database. If the wine already exists, no duplicate will be inserted.</span></p>
</li>
</ol><p><span>The enrichment steps:</span></p><p><span>From the production database, 3 datastreams read their data for getting trend/harvest/weather data respectively. Since this only works with expensive scraping and API calls (the scraping of vivino is significantly </span><em><span>cheaper</span></em><span>) and does not exist readily as a complete CSV file, it’s not part of the offline mode. All the existing enrichment data is immediately stored in our database and can be used to enrich wine with already present tuples.</span></p><ol>
<li><code>get_region_and_year</code><span>: Retrieves every unique region-vintage pair from the ddatabase, then writes it into a parquet file for subsequent use by the enrich_weather task.</span></li>
<li><code>get_grape_and_year</code><span>: Similarly retrieves every grape_type-vintage combination from the database for use by the enrich_trends task.</span></li>
<li><code>get_country_and_year</code><span>: Every country-vintage pair for enrich_harvest.</span></li>
<li><code>enrich_weather</code><span>: Row-by-row inserts every region-year pair, then checks if they have any missing weather attributes. If yes, then it will try to update the cells with missing values. </span><strong><span>If geopy cant fetch the location data for a region then it will be marked as a potentially invalid region</span></strong></li>
<li><code>enrich_trends</code><span>: Through the use of user cookies, google trends is queried for each grape_type-year pair where a value is missing for mean and median search trends. The success rate for this task varies a lot, depending on factors such as network traffic.</span></li>
<li><code>enrich_trends</code><span>: The faostat database is queried for each country-year pair in order to get the area of grape harvest, and the amount grape and wine made. There is no pre-check for existing values.</span></li>
<li><span>examine_regions: Regions marked as invalid are checked in the weather table to see if they have valied cells for other years. If yes, the mark is removed. This step is highly dependent on past data,and some wine regions have no clear association with weather stations or they do not posses an easily identifiable latitude/longitude.</span></li>
<li><code>region_cleaning</code><span>: Those rows in both weather and wines where no valid data is found the given regions are deleted.</span></li>
<li><code>finale</code><span>: If none of the tasks failed, the job is marked as a success.</span></li>
</ol><h2 id="Ingestion" data-id="Ingestion"><a class="anchor hidden-xs" href="#Ingestion" title="Ingestion"><span class="octicon octicon-link"></span></a><span>Ingestion</span></h2><p><span>For ingestion, we utilize a Jupyter notebook within a PapermillOperator to save the scraped data as Parquet file as advised during our initial presentation. The scraping itself is based on the vivino’s ‘explore’ section to find new wines. Since it would converge to 2000 items found, we included random restarts with additional parameters. One of the main parameters to maximize our results is the grape variety. It’s saved as an integer ID whose distribution is non-linear. To adapt the notebook contains a number generator producing fitting ID’s to scrape vivino. The amount of data to be scraped is parameterized in the notebook.</span></p><h2 id="Staging" data-id="Staging"><a class="anchor hidden-xs" href="#Staging" title="Staging"><span class="octicon octicon-link"></span></a><span>Staging</span></h2><p><span>The Staging area includes two main tasks: cleansing and enrichment.</span></p><h3 id="Cleansing" data-id="Cleansing"><a class="anchor hidden-xs" href="#Cleansing" title="Cleansing"><span class="octicon octicon-link"></span></a><span>Cleansing</span></h3><p><span>Upon scraping, duplicates are removed, and wine entries with missing data in key areas dropped. Region data is examined and then the discarding happens based on a whitelist-blacklist system, where regions which might end up on the blacklist due to programming logic may still be included. This is necessary because the following steps in our pipeline can be very resource-intensive, rendering it necessary to reduce the amount of new tuples as much as possible.</span>
<span>The scraped data is loaded from the Parquet file and entry-by-entry checked against the production data, inserting only those into production whose id is not already present there.</span>
<span>All production data itself has to be cleaned as well, since the list of rules is lagging by nature (based on Log files). This happens after all enrichment processes have concluded. Based on the feedback during our presentation, the database is now implemented in Postgres instead of MongoDB as the data is already structured.</span></p><h3 id="Enrichments" data-id="Enrichments"><a class="anchor hidden-xs" href="#Enrichments" title="Enrichments"><span class="octicon octicon-link"></span></a><span>Enrichments</span></h3><p><span>For the Google trends, our main obstacle is the unofficial API: basically a URL generator pasting the keyword and year into a URL template and using the </span><code>request</code><span> Python package to parse the result. The problem is the uninspired implementation of the latter, because one is immediately identified as a parser. Thus we had to come up with a fix: A connection set-up through manually created cookies</span></p><ol>
<li><span>Login with credentials on </span><a href="https://trends.google.com/trends/" target="_blank" rel="noopener"><span>Google Trends</span></a></li>
<li><span>Activate network on browser in developer view</span></li>
<li><span>Search for a keyword</span></li>
<li><span>Search for get GET package to that site and right-click </span><code>copy as cURL</code></li>
<li><span>Paste on website </span><a href="https://curlconverter.com/python/" target="_blank" rel="noopener"><span>curlconverter</span></a><span> to get cookies and headers for Python </span><code>request</code><span> package</span></li>
<li><span>Paste in dedicated section in code</span></li>
</ol><p><span>This could improve our success-rate in terms of stable connections from ~1% to ~25% - 60%. So we have to re-try for the tuples that can’t be found. The API calls are still very slow, which is the reason we try to avoid it as much as possible. This is also the reason our parser tries to find only very similar wines in every execution, so the API calls can be minimal.</span>
<span>We obtain the unique (Grape + Year)-Tuples from our recently cleaned new scraped data and for each of those we generate the mean and median search frequency, which is then appended to the respective table for the production data.</span></p><p><span>While wine can be consumed long after the year of the obtained trend, the vast majority of consumers follow a buy-and-drink approach instead of collecting </span><a href="http://winegourd.blogspot.com/2021/01/how-soon-is-wine-consumed-after-purchase.html" target="_blank" rel="noopener"><span>Source</span></a><span>. This is why we decided to match the trend with the production year. An easier and less data-intensive alternative would be to only include the current trend data. But since your ultimate goal is to be able to design and implement complex data pipelines we opted for the more difficult architecture.</span></p><p><span>For the harvest data our approach is very straight forward: We obtain the unique (Country + Year)-Tuples from the production data and for each of those we retrieve the Grape Production Area and Amount and the Wine Production Amount. These three features are then appended to the respective table for the production data.</span></p><p><span>The last enrichment data is the weather data: Since we aim for the exact weather data, the GPS location is extracted via </span><code>Geopy</code><span> from the </span><a href="http://vivino.com" target="_blank" rel="noopener"><span>vivino.com</span></a><span> region instead of country. The nature of a user-based website leads unfortunately to inaccuracies. If a region cannot be found, we log the region to later include in the cleaning process (often the grape type is entered as region on vivino).</span></p><p><span>Due to the nature of Geopy, some regions may be deemed invalid even though they are valid wine regions, for this reason a whitelist is maintained, which collects regions for which geopy cannot find the location, but are otherwise valid wine regions.</span></p><p><span>For the desired weather data, we average the </span><span class="mathjax raw">\(n\)</span><span> closest stations’ data for a more robust and granular time series.</span>
<span>We obtain the unique (Region + Year)-Tuples from the wine production data and for each of those we generate the following specifically engineered features for the growth period (March 11th – September 20th) of the wines:</span></p><ul>
<li><code>Vola_Temp</code><span>: Volatility of temperature</span></li>
<li><code>Vola_Rain</code><span>: Volatility of rain</span></li>
<li><code>Longest_Dry</code><span>: Longest period without rain</span></li>
<li><code>Longest_Wet</code><span>: Longest period with consecutive rain</span></li>
<li><code>Avg_Rain</code><span>: Average rain fall</span></li>
<li><code>Count_above35</code><span>: Number of days with temperature above 35 degrees</span></li>
<li><code>Count_under10</code><span>: Number of days with temperature below 10 degrees</span></li>
<li><code>Count_under0 </code><span>: Number of days with temperature below 0 degrees</span></li>
<li><code>Coulure_Wind</code><span>: Windspeed during the flowering</span></li>
<li><code>June_Rain</code><span>: Rain during the May-July period leading to mildew or oidium</span></li>
</ul><p><span>These </span><span class="mathjax raw">\(10\)</span><span> features are then appended to the respective table for the production data (the weather table).</span></p><h2 id="Production" data-id="Production"><a class="anchor hidden-xs" href="#Production" title="Production"><span class="octicon octicon-link"></span></a><span>Production</span></h2><p><span>Based on the input during our presentation, we switched from Neo4j to a more suitable star schema on Postgres where the vivino data is our fact table and the enrichment data are dimension tables:</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/main/assets/Schema.png?raw=true" width="650"><h3 id="Queries" data-id="Queries"><a class="anchor hidden-xs" href="#Queries" title="Queries"><span class="octicon octicon-link"></span></a><span>Queries</span></h3><p><span>The queries are designed to leverage our star schema and combine the fact table with one of the dimension tables each to generate the necessary data for our insights. Since we can actually use and apply all the data and need to apply various transformations, we will not merge it immediately via SQL, but within the </span><a href="https://github.com/trashpanda-ai/In_vino_veritas/blob/c8e3715a2eea25ca7a5480645741c869900da709/In%20vino%20veritas.ipynb" target="_blank" rel="noopener"><span>Jupyter Notebook</span></a><span> to transform each dataframe independently. One of the first analysis renders various boxplots showing the connection between vintage, price and rating. We can see how the price and rating grows with vintage and also loses its variance.</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Price%20by%20Year.png?raw=true" width="550"><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Rating%20by%20Year.png?raw=true" width="550"><p><span>We can also see that Rosé and White wine are significantly cheaper. We also see that the new world is leading the rankings … on a US based website… ;)</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Price%20by%20Wine%20Type.png?raw=true" width="550"><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Rating%20by%20Wine%20Type.png?raw=true" width="550"><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Rating%20by%20Country.png?raw=true" width="550"><p><span>Furthermore the question how price and rating are depending on each other is interesting, because it depends on the kind of wine: For red wine it’s a clear heteroscadacity without direct correlation, but sparkling wine shows a linear connection between price and ratings!</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Rating%20by%20Price%20per%20Category.png?raw=true" width="550"><p><span>We dived deeper into our data and used the taste dimensions of our wines to find correlations by means of a heatmap:</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Heatmap.png?raw=true" width="550"><p><span>To obtain more insights we also conduct a ANOVA test to see which variable explains the most variance in our data (here comparing red and sparkling wine):</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/ANOVA%20Rating%20Red%20Wine.png?raw=true" width="550"><p><span>This means, while for red wine the </span><code>dry-sweet</code><span> dimension is highly important, for the sparkling wine the price and number of reviews are relevant!</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/ANOVA%20Rating%20Sparkling%20Wine.png?raw=true" width="550"><p><span>We followed the same combined approach of heatmap and ANOVA test for our enrichment data:</span></p><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/Heatmap%20Enrichment.png?raw=true" width="550"><img src="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/plots/PNG/ANOVA%20Rating%20Enrichment.png?raw=true" width="550"><p><span>The wine quality data set is already cleaned and readily available and only needs to be loaded - here we visualized it with an interactive Bayesian network.</span></p><h1 id="Future-developments" data-id="Future-developments"><a class="anchor hidden-xs" href="#Future-developments" title="Future-developments"><span class="octicon octicon-link"></span></a><span>Future developments</span></h1><ol>
<li><span>One can parse </span><a href="https://www.winespectator.com/vintage-charts" target="_blank" rel="noopener"><span>lists</span></a><span> of ‘officially good’ wine years to select best weather features in terms of predictive modelling.</span></li>
<li><span>One can compare weather APIs (by number of NaNs and predictive qualities): meteostat vs open-meteo</span></li>
</ol><h1 id="Results-and-Conclusion" data-id="Results-and-Conclusion"><a class="anchor hidden-xs" href="#Results-and-Conclusion" title="Results-and-Conclusion"><span class="octicon octicon-link"></span></a><span>Results and Conclusion</span></h1><p><span>The </span><a href="https://github.com/trashpanda-ai/In_vino_veritas/blob/92aa1b6e915e38e72849a14b9e039f30a75336fb/In%20vino%20veritas.ipynb" target="_blank" rel="noopener"><span>Jupyter notebook</span></a><span> shows extremely interesting results! And even though the amount of data, we scraped is still not in the desired area of </span><em><span>Big Data</span></em><span>, we can conduct some insightful analysis.</span></p><p><span>Obstacles:</span></p><ul>
<li><span>Data needs to be either cleaned iteratively by hand (manual lists of regions to be changed) or we have to make rules that lead to some data loss</span></li>
<li><span>Parsing often ends in duplicates (resulting in constant database queries)</span></li>
<li><span>High dimensional data and many features</span></li>
<li><span>Obtaining sound and reliable weather data</span></li>
</ul><h1 id="How-to-run" data-id="How-to-run"><a class="anchor hidden-xs" href="#How-to-run" title="How-to-run"><span class="octicon octicon-link"></span></a><span>How to run?</span></h1><p><span>Since the dockerization is mostly based on the default docker compose yaml file, the setup is quite similar. Run these commands in the folder with the </span><code>docker-compose.yaml</code><span> file</span></p><ol>
<li><code>docker compose up airflow-init</code><span> (first time only)</span></li>
<li><code>docker compose up</code></li>
</ol><p><span>Then, connect to to the airflow localhost web UI through the appropriate port </span><code>(8080)</code><span>, use the following credentials  and launch the dag:</span></p><table>
<thead>
<tr>
<th><span>Login</span></th>
<th><span>Password</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>airflow</span></td>
<td><span>airflow</span></td>
</tr>
</tbody>
</table><p><span>If you want direct acces to the database:</span>
<code> docker exec -it in_vino_veritas-postgres-1 psql -U airflow -d postgres</code></p><p><span>Offline mode:</span>
<span>A static </span><code>.csv</code><span> file is included which can be read by enabling the </span><code>offline_mode</code><span> option when </span><em><span>manually triggering</span></em><span> the dag. This does not work on scheduled runs, as they will run with default settings.</span></p><p><span>Ports:</span></p><table>
<thead>
<tr>
<th><span>Service</span></th>
<th><span>URL</span></th>
</tr>
</thead>
<tbody>
<tr>
<td><span>Airflow</span></td>
<td><a href="http://localhost:8080/" target="_blank" rel="noopener"><span>http://localhost:8080/</span></a></td>
</tr>
<tr>
<td><span>PostGres</span></td>
<td><a href="http://localhost:5432/" target="_blank" rel="noopener"><span>http://localhost:5432/</span></a></td>
</tr>
</tbody>
</table></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#In-Vino-Veritas" title="In Vino Veritas">In Vino Veritas</a><ul class="nav">
<li class=""><a href="#Table-of-contents" title="Table of contents">Table of contents</a></li>
</ul>
</li>
<li class=""><a href="#Introduction" title="Introduction">Introduction</a></li>
<li class=""><a href="#Data-Sources" title="Data Sources">Data Sources</a><ul class="nav">
<li class=""><a href="#Main-Data" title="Main Data">Main Data</a></li>
<li class=""><a href="#Enrichment-Data" title="Enrichment Data">Enrichment Data</a></li>
</ul>
</li>
<li><a href="#Pipeline" title="Pipeline">Pipeline</a><ul class="nav">
<li><a href="#Ingestion" title="Ingestion">Ingestion</a></li>
<li><a href="#Staging" title="Staging">Staging</a><ul class="nav">
<li><a href="#Cleansing" title="Cleansing">Cleansing</a></li>
<li><a href="#Enrichments" title="Enrichments">Enrichments</a></li>
</ul>
</li>
<li><a href="#Production" title="Production">Production</a><ul class="nav">
<li><a href="#Queries" title="Queries">Queries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Future-developments" title="Future developments">Future developments</a></li>
<li><a href="#Results-and-Conclusion" title="Results and Conclusion">Results and Conclusion</a></li>
<li><a href="#How-to-run" title="How to run?">How to run?</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#In-Vino-Veritas" title="In Vino Veritas">In Vino Veritas</a><ul class="nav">
<li class=""><a href="#Table-of-contents" title="Table of contents">Table of contents</a></li>
</ul>
</li>
<li class=""><a href="#Introduction" title="Introduction">Introduction</a></li>
<li class=""><a href="#Data-Sources" title="Data Sources">Data Sources</a><ul class="nav">
<li class=""><a href="#Main-Data" title="Main Data">Main Data</a></li>
<li class=""><a href="#Enrichment-Data" title="Enrichment Data">Enrichment Data</a></li>
</ul>
</li>
<li><a href="#Pipeline" title="Pipeline">Pipeline</a><ul class="nav">
<li><a href="#Ingestion" title="Ingestion">Ingestion</a></li>
<li><a href="#Staging" title="Staging">Staging</a><ul class="nav">
<li><a href="#Cleansing" title="Cleansing">Cleansing</a></li>
<li><a href="#Enrichments" title="Enrichments">Enrichments</a></li>
</ul>
</li>
<li><a href="#Production" title="Production">Production</a><ul class="nav">
<li><a href="#Queries" title="Queries">Queries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#Future-developments" title="Future developments">Future developments</a></li>
<li><a href="#Results-and-Conclusion" title="Results and Conclusion">Results and Conclusion</a></li>
<li><a href="#How-to-run" title="How to run?">How to run?</a></li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">Expand all</a><a class="back-to-top" href="#">Back to top</a><a class="go-to-bottom" href="#">Go to bottom</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
